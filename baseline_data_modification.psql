

-- a query to generate a select query w/o some columns

SELECT 'SELECT ' || array_to_string(ARRAY(SELECT 'o' || '."' || c.column_name || '"' FROM information_schema.columns As c WHERE table_name = 'rpt__breed-rpt__other_breed' AND  c.column_name NOT IN('primary_key', 'secondary_key')), ',') || ' FROM "rpt__breed-rpt__other_breed" As o' As sqlstmt


-- merge the chicken production data into one sheet
create table chicken_production as
select b.secondary_key, b.primary_key, a."secd_d5_species",a."secd_d5_species_other",a."secd_d5_species-chicken",a."secd_d5_species-guinea_fowl",a."secd_d5_species-duck",a."secd_d5_species-turkey",a."secd_d5_species-other",a."grp_d6_rank-secd_d6_rank1",a."grp_d6_rank-secd_d6_rank2",a."grp_d6_rank-secd_d6_rank3",a."grp_d6_rank-secd_d6_rank4",a."grp_d6_rank-secd_d6_rank5",a."secd_d7_why_prefer",a."secd_d7_why_prefer_other",a."secd_d7_why_prefer-1",a."secd_d7_why_prefer-2",a."secd_d7_why_prefer-3",a."secd_d7_why_prefer-4",a."secd_d7_why_prefer-5",a."secd_d7_why_prefer-6",a."secd_d7_why_prefer-7",a."secd_d7_why_prefer-8",a."secd_d7_why_prefer-9",a."secd_d7_why_prefer-10",a."secd_d7_why_prefer-11",a."secd_d7_why_prefer-other", b."rpt__species-secd_d5_cur_species",b."rpt__species-secd_d5_cur_species_label",b."rpt__species-secd_d5_rank1",b."rpt__species-secd_d5_rank2",b."rpt__species-secd_d5_rank3",b."rpt__species-secd_d5_rank1_other",b."rpt__species-secd_d5_rank2_other",b."rpt__species-secd_d5_rank3_other"
from main_sheet as a inner join rpt__species as b on a.primary_key=b.secondary_key

-- merge the chicken inventory
create table chicken_inventory as 
select a.primary_key as secondary_key,"secd_d4_breed_types","secd_d4_breed_types-1","secd_d4_breed_types-2","secd_d4_breed_types-3","secd_d4_breed_types-4","secd_d4_breed_types-5",
b."rpt__breed-secd_d4_cur_breed",b."rpt__breed-secd_d4_cur_breed_label",b."rpt__breed-secd_d4_exotic_breed-30",b."rpt__breed-secd_d4_exotic_breed-31",b."rpt__breed-secd_d4_exotic_breed-32",b."rpt__breed-secd_d4_exotic_breed-1",b."rpt__breed-secd_d4_exotic_breed-2",b."rpt__breed-secd_d4_exotic_breed-3",b."rpt__breed-secd_d4_exotic_breed-4",b."rpt__breed-secd_d4_exotic_breed-5",b."rpt__breed-secd_d4_exotic_breed-6",b."rpt__breed-secd_d4_exotic_breed-7",b."rpt__breed-secd_d4_exotic_breed-8",b."rpt__breed-secd_d4_exotic_breed-9",b."rpt__breed-secd_d4_exotic_breed-10",b."rpt__breed-secd_d4_exotic_breed-11",b."rpt__breed-secd_d4_exotic_breed-12",b."rpt__breed-secd_d4_exotic_breed-13",b."rpt__breed-secd_d4_exotic_breed-29",b."rpt__breed-secd_d4_exotic_breed-other",b."rpt__breed-rpt__other_breed_count",b."rpt__breed-rpt__other_breed",b."rpt__breed-secd_d4_exotic_breed-14",b."rpt__breed-secd_d4_exotic_breed-15",b."rpt__breed-secd_d4_exotic_breed-16",b."rpt__breed-secd_d4_exotic_breed",b."rpt__breed-secd_d4_exotic_breed_other", o."rpt__breed-rpt__other_breed-secd_d4_cur_other_breed",o."rpt__breed-rpt__other_breed-secd_d4_cocks",o."rpt__breed-rpt__other_breed-secd_d4_hens",o."rpt__breed-rpt__other_breed-secd_d4_growers_male",o."rpt__breed-rpt__other_breed-secd_d4_growers_female",o."rpt__breed-rpt__other_breed-secd_d4_chicks",o."rpt__breed-rpt__other_breed-secd_d4_total_birds",o."rpt__breed-rpt__other_breed-secd_d4_total_birds_confirm",o."rpt__breed-rpt__other_breed-secd_d4_foundation_source",o."rpt__breed-rpt__other_breed-secd_d4_cur_other_breed_label",o."rpt__breed-rpt__other_breed-secd_d4_foundation_source_other"
from 
"main_sheet" as a
inner join "rpt__breed" as b on a.primary_key=b.secondary_key 
inner join "rpt__breed-rpt__other_breed" as o on b.primary_key=o.secondary_key;

-- Merge breeding table rpt__breeding with some of data from top level columns
create table bird_breeding as 
select b.primary_key, a.primary_key as secondary, a.secf_f3_hen_cock, a."secf_f3_hen_cock-hen", a."secf_f3_hen_cock-cock",
b."rpt__breeding-secf_f3_trait1",b."rpt__breeding-secf_f3_trait2",b."rpt__breeding-secf_f3_trait3",b."rpt__breeding-secf_f3_trait4",b."rpt__breeding-secf_f3_trait5",b."rpt__breeding-secf_f3_trait5_other",b."rpt__breeding-secf_f3_trait2_other",b."rpt__breeding-secf_f3_trait3_other",b."rpt__breeding-secf_f3_trait4_other",b."rpt__breeding-secf_f3_sex",b."rpt__breeding-secf_f3_sex_label",b."rpt__breeding-secf_f3_trait1_other"
FROM main_sheet as a 
inner join "rpt__breeding" As b on a.primary_key=b.secondary_key

-- Merge the chicken entries
select a.primary_key, a."secd_d8_entries", a."secd_d8_entry_type", a."secd_d8_entry_type-1", a."secd_d8_entry_type-2", a."secd_d8_entry_type-3", a."secd_d8_entry_type-4", a."secd_d8_entry_type-5", a."secd_d8_entry_type-other", a."secd_d8_entry_type_other",
b."rpt__entries-secd_d8_cur_entry",b."rpt__entries-secd_d8_cur_entry_label",b."rpt__entries-secd_d9_type-1",b."rpt__entries-secd_d9_type-2",b."rpt__entries-secd_d9_type-3",b."rpt__entries-secd_d9_type-4",b."rpt__entries-secd_d9_type-5",b."rpt__entries-secd_d9_type-other",b."rpt__entries-rpt_d9_chicken_type_count",b."rpt__entries-rpt_d9_chicken_type",b."rpt__entries-secd_d9_type_other",b."rpt__entries-secd_d9_type",
d."rpt__entries-rpt_d9_chicken_type-secd_d9_cur_chk_type",d."rpt__entries-rpt_d9_chicken_type-secd_d9_cur_chk_label",d."rpt__entries-rpt_d9_chicken_type-secd_d9_breed",d."rpt__entries-rpt_d9_chicken_type-secd_d9_breed-1",d."rpt__entries-rpt_d9_chicken_type-secd_d9_breed-2",d."rpt__entries-rpt_d9_chicken_type-secd_d9_breed-3",d."rpt__entries-rpt_d9_chicken_type-secd_d9_breed-4",d."rpt__entries-rpt_d9_chicken_type-secd_d9_breed-5",d."rpt__entries-rpt_d9_chicken_type-rpt_d9__count",d."rpt__entries-rpt_d9_chicken_type-rpt_d9_",
e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-secd_d9_cur_breed",e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-secd_d9_no_birds",e."rpt_d9_chicken_type-rpt_d9_-rpt_d9_mkt_channel_count",e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-secd_d9_mkt_channel",e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-secd_d9_mkt_channel-1",e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-secd_d9_mkt_channel-2",e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-secd_d9_mkt_channel-3",e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-secd_d9_mkt_channel-4",e."rpt_d9_chicken_type-rpt_d9_-secd_d9_mkt_channel-other",e."rpt_d9_chicken_type-rpt_d9_-secd_d9_mkt_channel_other",e."rpt__entries-rpt_d9_chicken_type-rpt_d9_-rpt_d9_mkt_channel",e."rpt_d9_chicken_type-rpt_d9_-secd_d9_cur_breed_label",
f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_cur_mkt_channel",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_cur_mkt_channel_label",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_no_birds_pur",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_birds_cost",f."rpt_d9_chicken_type-rpt_d9_-rpt_d9_mkt_channel-secd_d9_pay_mode",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_pur_who_decide",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_trans_mode",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_dist_pur_place",f."rpt_d9_chicken_type-rpt_d9_-rpt_d9_mkt_channel-secd_d9_who_paid",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_trans_cost",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_pay_mode_other",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_pur_reason_other",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_pur_who_decide_other",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_pur_reason",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_trans_mode_other",f."rpt_d9_-rpt_d9_mkt_channel-secd_d9_who_paid_other"
FROM main_sheet as a 
left join "rpt__entries" as b on a.primary_key=b.secondary_key
left join "-rpt_d9_chicken_type" As d on b.primary_key=d.secondary_key
left join "-rpt_d9_chicken_type-rpt_d9_" As e on d.primary_key=e.secondary_key
left join "-rpt_d9_-rpt_d9_mkt_channel" As f on e.primary_key=f.secondary_key

-- Merging chicken marketing
select a.primary_key as secondary_key, a."sece_e1_eggs_sold", a."grp__eggs_sold-sece_e2_breed", a."grp__eggs_sold-sece_e2_breed-1", a."grp__eggs_sold-sece_e2_breed-2", a."grp__eggs_sold-sece_e2_breed-3", a."grp__eggs_sold-sece_e2_breed-4", a."grp__eggs_sold-sece_e2_breed-5", a."grp__eggs_sold-sece_e2_breed-6",
b."grp__eggs_sold-rpt_e2_breed-sece_e2_cur_breed",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-1",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-2",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-3",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-4",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-5",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-6",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-7",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-8",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel-other",b."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt_count",b."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel_other",b."grp__eggs_sold-rpt_e2_breed-sece_e2_cur_breed_label",b."grp__eggs_sold-rpt_e2_breed-sece_e2_mkt_channel",
c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_cur_mkt",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_cur_mkt_label",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_egg_price",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_no_days",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_no_sold",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_pay_mode",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason-1",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason-2",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason-3",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason-4",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason-5",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason-6",c."rpt_e2_breed-rpt_e2_mkt-sece_e2_sale_reason-other",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_sell_who_decide",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_trans_mode",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_dist_sale_place",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_who_paid",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_trans_cost",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_pay_mode_other",c."rpt_e2_breed-rpt_e2_mkt-sece_e2_sell_who_decide_other",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_who_paid_other",c."grp__eggs_sold-rpt_e2_breed-rpt_e2_mkt-sece_e2_trans_mode_other"
FROM 
main_sheet as a
inner join "grp__eggs_sold-rpt_e2_breed" As b on a.primary_key=b.secondary_key
inner join "-rpt_e2_breed-rpt_e2_mkt" As c on b.primary_key=c.secondary_key

-- Merging the products sold
select a."sece_e3_products_sold", a."grp_e3_-sece_e4_product_type", a."grp_e3_-sece_e4_product_type-2", a."grp_e3_-sece_e4_product_type-3", a."grp_e3_-sece_e4_product_type-4", a."grp_e3_-sece_e4_product_type-other", a."grp_e3_-sece_e4_product_type_other", b."grp_e3_-rpt_e4_product-sece_e4_cur_product_label",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-1",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-2",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-3",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-4",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-5",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-6",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-7",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-8",b."grp_e3_-rpt_e4_product-sece_e4_mkt_channel-other",b."grp_e3_-rpt_e4_product-rpt_e4_mkt_count",b."grp_e3_-rpt_e4_product-rpt_e4_mkt",b."grp_e3_-rpt_e4_product-sece_e4_cur_product"
FROM main_sheet as a
inner join "grp_e3_-rpt_e4_product" As b


-- Merging chicken exits
select a.primary_key, a."secd_d11_exit_type", a."secd_d11_exit_type-1", a."secd_d11_exit_type-2", a."secd_d11_exit_type-3", a."secd_d11_exit_type-4", a."secd_d11_exit_type-5", a."secd_d11_exit_type-6", a."secd_d11_exit_type-7", a."secd_d11_exit_type-8", a."secd_d11_exit_type-9", a."secd_d11_exit_type-10", a."secd_d11_exit_type-11", a."secd_d11_exit_type-12", a."secd_d11_exit_type-13", a."secd_d11_exit_type-other", a."secd_d11_exit_type_other",
b."rpt__exits-secd_d11_cur_exit",b."rpt__exits-secd_d11_cur_exit_label",b."rpt__exits-secd_d11_type",b."rpt__exits-secd_d11_type-1",b."rpt__exits-secd_d11_type-2",b."rpt__exits-secd_d11_type-3",b."rpt__exits-secd_d11_type-4",b."rpt__exits-secd_d11_type-5",b."rpt__exits-secd_d11_type-other",b."rpt__exits-rpt_d11_chicken_type_count",b."rpt__exits-rpt_d11_chicken_type",
c."rpt__exits-rpt_d11_chicken_type-secd_d11_cur_chk_type",c."rpt__exits-rpt_d11_chicken_type-secd_d11_cur_chk_label",c."rpt__exits-rpt_d11_chicken_type-secd_d11_breed",c."rpt__exits-rpt_d11_chicken_type-secd_d11_breed-1",c."rpt__exits-rpt_d11_chicken_type-secd_d11_breed-2",c."rpt__exits-rpt_d11_chicken_type-secd_d11_breed-3",c."rpt__exits-rpt_d11_chicken_type-secd_d11_breed-4",c."rpt__exits-rpt_d11_chicken_type-secd_d11_breed-5",c."rpt__exits-rpt_d11_chicken_type-rpt_d11__count",c."rpt__exits-rpt_d11_chicken_type-rpt_d11_",
d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-1",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-2",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-3",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-4",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-5",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-6",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-7",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-8",d."rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel-other",d."rpt_d11_chicken_type-rpt_d11_-rpt_d11_mkt_channel_count",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-rpt_d11_mkt_channel",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_no_birds",d."rpt_d11_chicken_type-rpt_d11_-secd_d11_mkt_channel_other",d."rpt__exits-rpt_d11_chicken_type-rpt_d11_-secd_d11_cur_breed",d."rpt_d11_chicken_type-rpt_d11_-secd_d11_cur_breed_label",
e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_cur_mkt_channel",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_cur_mkt_channel_label",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_no_birds_sold",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_birds_cost",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_pay_mode",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_sell_who_decide",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_trans_mode",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_dist_pur_place",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_who_paid",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_trans_cost",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_pay_mode_other",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_trans_mode_other",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_sell_who_decide_other",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_sell_reason",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_sell_reason_other",e."rpt_d11_-rpt_d11_mkt_channel-secd_d11_who_paid_other"
FROM
main_sheet as a
inner join "rpt__exits" As b on a.primary_key=b.secondary_key
inner join "-rpt_d11_chicken_type" As c on b.primary_key=c.secondary_key
inner join "-rpt_d11_chicken_type-rpt_d11_" As d on c.primary_key=d.secondary_key
inner join "-rpt_d11_-rpt_d11_mkt_channel" As e on d.primary_key=e.secondary_key


-- Merge feeding tables
select a.primary_key,
a."secg_g7_sup_feed", a."secg_g7_months", a."secg_g7_months-jan", a."secg_g7_months-feb", a."secg_g7_months-mar", a."secg_g7_months-apr", a."secg_g7_months-may", a."secg_g7_months-jun", a."secg_g7_months-jul", a."secg_g7_months-aug", a."secg_g7_months-sep", a."secg_g7_months-oct", a."secg_g7_months-nov", a."secg_g7_months-dec", a."secg_g8_why_no_supp", a."secg_g8_why_no_supp-1", a."secg_g8_why_no_supp-2", a."secg_g8_why_no_supp-3", a."secg_g8_why_no_supp-4", a."secg_g8_why_no_supp-5", a."secg_g8_why_no_supp-other", a."secg_g8_why_no_supp_other", a."secg_g9_feed", a."secg_g9_feed-1", a."secg_g9_feed-2", a."secg_g9_feed-3", a."secg_g9_feed-4", a."secg_g9_feed-5", a."secg_g9_feed-6",  a."secg_g9_feed-7", a."secg_g9_feed-other", a."secg_g9_feed_other",
b."rpt__sup_feed-secg_g9_cur_feed_label",b."rpt__sup_feed-secg_g9_breed_type",b."rpt__sup_feed-secg_g9_breed_type-1",b."rpt__sup_feed-secg_g9_breed_type-2",b."rpt__sup_feed-secg_g9_breed_type-3",b."rpt__sup_feed-secg_g9_breed_type-4",b."rpt__sup_feed-secg_g9_breed_type-5",b."rpt__sup_feed-secg_g9_breed_type-6",b."rpt__sup_feed-secg_g9_breed_type-other",b."rpt__sup_feed-rpt_g9__count",b."rpt__sup_feed-rpt_g9_",b."rpt__sup_feed-secg_g9_breed_type_other",b."rpt__sup_feed-secg_g9_cur_feed",
c."rpt__sup_feed-rpt_g9_-secg_g9_cur_breed_label",c."rpt__sup_feed-rpt_g9_-secg_g9_feed_time",c."rpt__sup_feed-rpt_g9_-secg_g9_process_feed",c."rpt__sup_feed-rpt_g9_-secg_g9_feed_method",c."rpt__sup_feed-rpt_g9_-secg_g9_feed_source",c."rpt__sup_feed-rpt_g9_-secg_g9_times_purchased",c."rpt__sup_feed-rpt_g9_-secg_g9_av_month_cost",c."rpt__sup_feed-rpt_g9_-secg_g9_mkt_channel",c."rpt__sup_feed-rpt_g9_-secg_g9_trans_mode",c."rpt__sup_feed-rpt_g9_-secg_g9_trans_cost",c."rpt__sup_feed-rpt_g9_-secg_g9_cur_breed",c."rpt__sup_feed-rpt_g9_-secg_g9_process_feed_other",c."rpt__sup_feed-rpt_g9_-secg_g9_mkt_channel_other",c."rpt__sup_feed-rpt_g9_-secg_g9_feed_method_other",c."rpt__sup_feed-rpt_g9_-secg_g9_trans_mode_other"
FROM
main_sheet as a
inner join "rpt__sup_feed" As b on a.primary_key = b.secondary_key
inner join "rpt__sup_feed-rpt_g9_" As c on b.primary_key = c.secondary_key

-- Other sources of income
create table other_income_sources as 
select a.primary_key,a."secl_l1_source_income",a."secl_l1_source_income-1",a."secl_l1_source_income-2",a."secl_l1_source_income-3",a."secl_l1_source_income-4",a."secl_l1_source_income-5",a."secl_l1_source_income-6",a."secl_l1_source_income-7",a."secl_l1_source_income-8",a."secl_l1_source_income-9",a."secl_l1_source_income-10",a."secl_l1_source_income-11",a."secl_l1_source_income-12",a."secl_l1_source_income-13",a."secl_l1_source_income-other",a."secl_l1_source_income_other",a."rpt_l1__count",a."rpt_l1_",b."rpt_l1_-secl_l1_cur_income",b."rpt_l1_-secl_l1_cur_income_label",b."rpt_l1_-secl_l1_total_income",b."rpt_l1_-secl_l1_source_rank",b."rpt_l1_-secl_l1_source_earner",b."rpt_l1_-secl_l1_source_earner_other",b."rpt_l1_-secl_l1_source_control" from main_sheet as a inner join "rpt_l1_" as b on a.primary_key=b.secondary_key;

-- Income level table
create table income_levels as select primary_key, "secl_l2_av_month_income", "secl_l3_chicken_income" from main_sheet;

-- Livestock Ownership table
create table livestock_ownership as select a.primary_key,a."sec_liv_c19_owned_livestock",a."sec_liv_c19_owned_livestock-cattle",a."sec_liv_c19_owned_livestock-goats",a."sec_liv_c19_owned_livestock-sheep",a."sec_liv_c19_owned_livestock-other",a."sec_liv_c19_owned_livestock-none",a."sec_liv_c19_owned_livestock_other",a."rpt_c19_",a."rpt_c19__count",b."rpt_c19_-sec_liv_c19_cur_livestock",b."rpt_c19_-sec_liv_c19_cur_livestock_name",b."rpt_c19_-sec_liv_local_male_owned",b."rpt_c19_-sec_liv_local_female_owned",b."rpt_c19_-sec_liv_local_jointly_owned",b."rpt_c19_-sec_liv_local_total_owned",b."rpt_c19_-sec_liv_local_confirm",b."rpt_c19_-sec_liv_cross_male_owned",b."rpt_c19_-sec_liv_cross_female_owned",b."rpt_c19_-sec_liv_cross_jointly_owned",b."rpt_c19_-sec_liv_cross_total_owned",b."rpt_c19_-sec_liv_cross_confirm",a."secc_c20_other_livestock",a."secc_c20_other_livestock-guineafowl",a."secc_c20_other_livestock-duck",a."secc_c20_other_livestock-turkey",a."secc_c20_other_livestock-donkey",a."secc_c20_other_livestock-rabbits",a."secc_c20_other_livestock-none",a."secc_c20_other_livestock-other",a."secc_c20_other_livestock_other",a."rpt_c20_",a."rpt_c20__count",c."rpt_c20_-sec_liv_c20_cur_livestock",c."rpt_c20_-sec_liv_c20_cur_livestock_name",c."rpt_c20_-sec_liv_c20_male_owned",c."rpt_c20_-sec_liv_c20_female_owned",c."rpt_c20_-sec_liv_c20_jointly_owned",c."rpt_c20_-sec_liv_c20_total_owned",c."rpt_c20_-sec_liv_c20_confirm"
from main_sheet as a inner join "rpt_c19_" as b on a.primary_key=b.secondary_key inner join "rpt_c20_" as c on a.primary_key=c.secondary_key
